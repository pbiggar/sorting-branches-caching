% Remember to use the lgrind style

\Head{}
\File{radixsort\_code}{2004}{4}{28}{4:31}{1087}
\L{\LB{\K{\#include}_\S{}\3base\_sorts.h\3\SE{}}}
\L{\LB{}}
\L{\LB{\K{\#define}_\V{THRESHHOLD}_\N{10}}}
\L{\LB{}}
\L{\LB{\K{\#define}_\V{bitsword}_\N{32}}}
\L{\LB{\K{\#define}_\V{bitsbyte}_\N{8}}}
\L{\LB{\K{\#define}_\V{bytesword}_\N{4}}}
\L{\LB{\K{\#define}_\V{Radix}_(\N{1}_\<\<_\V{bitsbyte})}}
\L{\LB{}}
\L{\LB{\K{\#define}_\V{digit}(\V{A},_\V{B})_(((\V{A})_\>\>_(\V{bitsword}\-((\V{B})+\N{1})*\V{bitsbyte}))_\&_(\V{Radix}\-\N{1}))}}
\L{\LB{}}
\L{\LB{\K{unsigned}_\K{int}*_\V{radix\_aux};}}
\L{\LB{}}
\L{\LB{\K{void}}}
\index{radixLSD}\Proc{radixLSD}\L{\LB{\V{radixLSD}(\K{unsigned}_\K{int}_\V{a}[\,],_\K{int}_\V{l},_\K{int}_\V{r})}}
\L{\LB{\{}}
\L{\LB{}\Tab{8}{\C{}/*_R_is_the_size_of_a_digit,_hence_the_number_of_bins_*/\CE{}}}
\L{\LB{}\Tab{8}{\K{int}_\V{i},_\V{j},_\V{w},_\V{count}[\V{Radix}+\N{1}];_}}
\L{\LB{}}
\L{\LB{}\Tab{8}{\C{}/*_this_is_from_lsb._3_==_lsByte,_0_==_msByte_*/\CE{}}}
\L{\LB{}\Tab{8}{\K{for}(\V{w}_=_\V{bytesword}_\-_\N{1};_\V{w}_\>=_\N{0};_\V{w}\-\-)_}}
\L{\LB{}\Tab{8}{\{}}
\L{\LB{}\Tab{16}{\C{}/*_set_the_counts_to_0_*/\CE{}}}
\L{\LB{}\Tab{16}{\K{for}(\V{j}_=_\N{0};_\V{j}_\<_\V{Radix};_\V{j}++)_\V{count}[\V{j}]_=_\N{0};_}}
\L{\LB{}\Tab{16}{\K{for}(\V{i}_=_\V{l};_\V{i}_\<=_\V{r};_\V{i}++)_\C{}/*_count_each_digit_*/\CE{}}}
\L{\LB{}\Tab{16}{\{}}
\L{\LB{}\Tab{24}{\V{count}[\V{digit}(\V{a}[\V{i}],_\V{w})_+_\N{1}]++;}}
\L{\LB{}\Tab{16}{\}}}
\L{\LB{}\Tab{16}{\C{}/*_make_the_count_cumulatative_*/\CE{}}}
\L{\LB{}\Tab{16}{\K{for}(\V{j}_=_\N{1};_\V{j}_\<_\V{Radix};_\V{j}++)_}}
\L{\LB{}\Tab{16}{\{}}
\L{\LB{}\Tab{24}{\V{count}[\V{j}]_+=_\V{count}[\V{j}\-\N{1}];}}
\L{\LB{}\Tab{16}{\}}}
\L{\LB{}\Tab{16}{\C{}/*_when_we_look_up_the_array,_we_now_have_its_position_*/\CE{}}}
\L{\LB{}\Tab{16}{\K{for}(\V{i}_=_\V{l};_\V{i}_\<=_\V{r};_\V{i}++)_}}
\L{\LB{}\Tab{16}{\{}}
\L{\LB{}\Tab{24}{\V{radix\_aux}[\V{count}[\V{digit}(\V{a}[\V{i}],_\V{w})]++]_=_\V{a}[\V{i}];}}
\L{\LB{}\Tab{16}{\}}}
\L{\LB{}\Tab{16}{\K{for}(\V{i}_=_\V{l};_\V{i}_\<=_\V{r};_\V{i}++)_\C{}/*_copy_it_back_*/\CE{}}}
\L{\LB{}\Tab{16}{\{}}
\L{\LB{}\Tab{24}{\V{a}[\V{i}]_=_\V{radix\_aux}[\V{i}];}}
\L{\LB{}\Tab{16}{\}}}
\L{\LB{}\Tab{8}{\}}}
\L{\LB{\}}}
\L{\LB{}}
\L{\LB{\K{void}}}
\index{base\_radixsort}\Proc{base\_radixsort}\L{\LB{\V{base\_radixsort}(\K{unsigned}_\K{int}_\V{a}[\,],_\K{int}_\V{N})}}
\L{\LB{\{}}
\L{\LB{}\Tab{8}{\V{radix\_aux}_=_\V{malloc}(\V{N}_*_\K{sizeof}(\K{unsigned}_\K{int}));}}
\L{\LB{}\Tab{8}{\V{radixLSD}(\V{a},_\N{0},_\V{N}\-\N{1});}}
\L{\LB{}\Tab{8}{\V{free}(\V{radix\_aux});}}
\L{\LB{\}}}
